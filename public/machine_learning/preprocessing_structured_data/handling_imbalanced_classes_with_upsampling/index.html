<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Handling Imbalanced Classes With Upsampling" />
<meta property="og:description" content="How to handle imbalanced classes with upsampling during machine learning in Python." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chrisalbon.com/machine_learning/preprocessing_structured_data/handling_imbalanced_classes_with_upsampling/" />



<meta property="article:published_time" content="2017-12-20T11:53:49-07:00"/>

<meta property="article:modified_time" content="2017-12-20T11:53:49-07:00"/>











<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Handling Imbalanced Classes With Upsampling"/>
<meta name="twitter:description" content="How to handle imbalanced classes with upsampling during machine learning in Python."/>
<meta name="generator" content="Hugo 0.31.1" />

    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Handling Imbalanced Classes With Upsampling",
  "url": "https://chrisalbon.com/machine_learning/preprocessing_structured_data/handling_imbalanced_classes_with_upsampling/",
  "wordCount": "489",
  "datePublished": "2017-12-20T11:53:49-07:00",
  "dateModified": "2017-12-20T11:53:49-07:00",
  "author": {
    "@type": "Person",
    "name": "Chris Albon"
  },
  "description": "How to handle imbalanced classes with upsampling during machine learning in Python."
}
</script>



    <link rel="canonical" href="https://chrisalbon.com/machine_learning/preprocessing_structured_data/handling_imbalanced_classes_with_upsampling/">

    <title>Handling Imbalanced Classes With Upsampling | Chris Albon</title>

    <!-- combined, minified CSS -->
    <link href="https://chrisalbon.com/css/style.css" rel="stylesheet" integrity="" crossorigin="anonymous">
    <link href="https://chrisalbon.com/css/main.css" rel="stylesheet" integrity="" crossorigin="anonymous">

    

    

    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

  </head>

  <body>

    <div class="blog-masthead">
      <div class="container">
        <nav class="nav blog-nav">
          <a class="nav-link" href="https://chrisalbon.com/">Home</a></nav>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-sm-12 blog-main">

          


<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="https://chrisalbon.com/machine_learning/preprocessing_structured_data/handling_imbalanced_classes_with_upsampling/">Handling Imbalanced Classes With Upsampling</a></h2>
    <p class="blog-post-meta"><time datetime="2017-12-20T11:53:49-07:00">Wed Dec 20, 2017</time></p>
  </header>
  

<p><a alt="Upsampling" href="https://machinelearningflashcards.com">
    <img src="handling_imbalanced_classes_with_upsampling/Upsampling_print.png" class="flashcard center-block">
</a></p>

<p>In upsampling, for every observation in the majority class, we randomly select an observation from the minority class with replacement. The end result is the same number of observations from the minority and majority classes.</p>

<h2 id="preliminaries">Preliminaries</h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Load libraries</span>
<span style="color:#080;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">numpy</span> <span style="color:#080;font-weight:bold">as</span> <span style="color:#0e84b5;font-weight:bold">np</span>
<span style="color:#080;font-weight:bold">from</span> <span style="color:#0e84b5;font-weight:bold">sklearn.datasets</span> <span style="color:#080;font-weight:bold">import</span> load_iris</code></pre></div>
<h2 id="load-iris-dataset">Load Iris Dataset</h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Load iris data</span>
iris <span style="color:#333">=</span> load_iris()

<span style="color:#888"># Create feature matrix</span>
X <span style="color:#333">=</span> iris<span style="color:#333">.</span>data

<span style="color:#888"># Create target vector</span>
y <span style="color:#333">=</span> iris<span style="color:#333">.</span>target</code></pre></div>
<h2 id="make-iris-dataset-imbalanced">Make Iris Dataset Imbalanced</h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Remove first 40 observations</span>
X <span style="color:#333">=</span> X[<span style="color:#00d;font-weight:bold">40</span>:,:]
y <span style="color:#333">=</span> y[<span style="color:#00d;font-weight:bold">40</span>:]

<span style="color:#888"># Create binary target vector indicating if class 0</span>
y <span style="color:#333">=</span> np<span style="color:#333">.</span>where((y <span style="color:#333">==</span> <span style="color:#00d;font-weight:bold">0</span>), <span style="color:#00d;font-weight:bold">0</span>, <span style="color:#00d;font-weight:bold">1</span>)

<span style="color:#888"># Look at the imbalanced target vector</span>
y</code></pre></div>
<pre><code>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
</code></pre>

<h2 id="upsampling-minority-class-to-match-majority">Upsampling Minority Class To Match Majority</h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Indicies of each class&#39; observations</span>
i_class0 <span style="color:#333">=</span> np<span style="color:#333">.</span>where(y <span style="color:#333">==</span> <span style="color:#00d;font-weight:bold">0</span>)[<span style="color:#00d;font-weight:bold">0</span>]
i_class1 <span style="color:#333">=</span> np<span style="color:#333">.</span>where(y <span style="color:#333">==</span> <span style="color:#00d;font-weight:bold">1</span>)[<span style="color:#00d;font-weight:bold">0</span>]

<span style="color:#888"># Number of observations in each class</span>
n_class0 <span style="color:#333">=</span> <span style="color:#007020">len</span>(i_class0)
n_class1 <span style="color:#333">=</span> <span style="color:#007020">len</span>(i_class1)

<span style="color:#888"># For every observation in class 1, randomly sample from class 0 with replacement</span>
i_class0_upsampled <span style="color:#333">=</span> np<span style="color:#333">.</span>random<span style="color:#333">.</span>choice(i_class0, size<span style="color:#333">=</span>n_class1, replace<span style="color:#333">=</span>True)

<span style="color:#888"># Join together class 0&#39;s upsampled target vector with class 1&#39;s target vector</span>
np<span style="color:#333">.</span>concatenate((y[i_class0_upsampled], y[i_class1]))</code></pre></div>
<pre><code>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
       0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
</code></pre>


</article> 



        </div> <!-- /.blog-main -->

      </div> <!-- /.row -->
    </div> <!-- /.container -->

    <footer class="blog-footer">
      <p>
      
      Blog template created by <a href="https://twitter.com/mdo">@mdo</a>, ported to Hugo by <a href='https://twitter.com/mralanorth'>@mralanorth</a>.
      
      </p>
    </footer>

  </body>

</html>
