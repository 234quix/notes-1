<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Multinomial Naive Bayes Classifier" />
<meta property="og:description" content="How to train a Multinomial naive bayes classifer in Scikit-Learn" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chrisalbon.com/machine_learning/naive_bayes/multinomial_naive_bayes_classifier/" />



<meta property="article:published_time" content="2017-12-20T11:53:49-07:00"/>

<meta property="article:modified_time" content="2017-12-20T11:53:49-07:00"/>











<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Multinomial Naive Bayes Classifier"/>
<meta name="twitter:description" content="How to train a Multinomial naive bayes classifer in Scikit-Learn"/>
<meta name="generator" content="Hugo 0.31.1" />

    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Multinomial Naive Bayes Classifier",
  "url": "https://chrisalbon.com/machine_learning/naive_bayes/multinomial_naive_bayes_classifier/",
  "wordCount": "161",
  "datePublished": "2017-12-20T11:53:49-07:00",
  "dateModified": "2017-12-20T11:53:49-07:00",
  "author": {
    "@type": "Person",
    "name": "Chris Albon"
  },
  "description": "How to train a Multinomial naive bayes classifer in Scikit-Learn"
}
</script>



    <link rel="canonical" href="https://chrisalbon.com/machine_learning/naive_bayes/multinomial_naive_bayes_classifier/">

    <title>Multinomial Naive Bayes Classifier | Chris Albon</title>

    <!-- combined, minified CSS -->
    <link href="https://chrisalbon.com/css/style.css" rel="stylesheet" integrity="" crossorigin="anonymous">
    <link href="https://chrisalbon.com/css/main.css" rel="stylesheet" integrity="" crossorigin="anonymous">

    

    

    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

  </head>

  <body>

    <div class="blog-masthead">
      <div class="container">
        <nav class="nav blog-nav">
          <a class="nav-link" href="https://chrisalbon.com/">Home</a></nav>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-sm-12 blog-main">

          


<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="https://chrisalbon.com/machine_learning/naive_bayes/multinomial_naive_bayes_classifier/">Multinomial Naive Bayes Classifier</a></h2>
    <p class="blog-post-meta"><time datetime="2017-12-20T11:53:49-07:00">Wed Dec 20, 2017</time></p>
  </header>
  

<p>Multinomial naive Bayes works similar to Gaussian naive Bayes, however the features are assumed to be multinomially distributed. In practice, this means that this classifier is commonly used when we have discrete data (e.g. movie ratings ranging 1 and 5).</p>

<h2 id="preliminaries">Preliminaries</h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Load libraries</span>
<span style="color:#080;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">numpy</span> <span style="color:#080;font-weight:bold">as</span> <span style="color:#0e84b5;font-weight:bold">np</span>
<span style="color:#080;font-weight:bold">from</span> <span style="color:#0e84b5;font-weight:bold">sklearn.naive_bayes</span> <span style="color:#080;font-weight:bold">import</span> MultinomialNB
<span style="color:#080;font-weight:bold">from</span> <span style="color:#0e84b5;font-weight:bold">sklearn.feature_extraction.text</span> <span style="color:#080;font-weight:bold">import</span> CountVectorizer</code></pre></div>
<h2 id="create-text-data">Create Text Data</h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Create text</span>
text_data <span style="color:#333">=</span> np<span style="color:#333">.</span>array([<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;I love Brazil. Brazil!&#39;</span>,
                      <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Brazil is best&#39;</span>,
                      <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Germany beats both&#39;</span>])</code></pre></div>
<h2 id="create-bag-of-words">Create Bag Of Words</h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Create bag of words</span>
count <span style="color:#333">=</span> CountVectorizer()
bag_of_words <span style="color:#333">=</span> count<span style="color:#333">.</span>fit_transform(text_data)

<span style="color:#888"># Create feature matrix</span>
X <span style="color:#333">=</span> bag_of_words<span style="color:#333">.</span>toarray()</code></pre></div>
<h2 id="create-target-vector">Create Target Vector</h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Create target vector</span>
y <span style="color:#333">=</span> np<span style="color:#333">.</span>array([<span style="color:#00d;font-weight:bold">0</span>,<span style="color:#00d;font-weight:bold">0</span>,<span style="color:#00d;font-weight:bold">1</span>])</code></pre></div>
<h2 id="train-multinomial-naive-bayes-classifier">Train Multinomial Naive Bayes Classifier</h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Create multinomial naive Bayes object with prior probabilities of each class</span>
clf <span style="color:#333">=</span> MultinomialNB(class_prior<span style="color:#333">=</span>[<span style="color:#60e;font-weight:bold">0.25</span>, <span style="color:#60e;font-weight:bold">0.5</span>])

<span style="color:#888"># Train model</span>
model <span style="color:#333">=</span> clf<span style="color:#333">.</span>fit(X, y)</code></pre></div>
<h2 id="create-previously-unseen-observation">Create Previously Unseen Observation</h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Create new observation</span>
new_observation <span style="color:#333">=</span> [[<span style="color:#00d;font-weight:bold">0</span>, <span style="color:#00d;font-weight:bold">0</span>, <span style="color:#00d;font-weight:bold">0</span>, <span style="color:#00d;font-weight:bold">1</span>, <span style="color:#00d;font-weight:bold">0</span>, <span style="color:#00d;font-weight:bold">1</span>, <span style="color:#00d;font-weight:bold">0</span>]]</code></pre></div>
<h2 id="predict-observation-s-class">Predict Observation&rsquo;s Class</h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Predict new observation&#39;s class</span>
model<span style="color:#333">.</span>predict(new_observation)</code></pre></div>
<pre><code>array([0])
</code></pre>


</article> 



        </div> <!-- /.blog-main -->

      </div> <!-- /.row -->
    </div> <!-- /.container -->

    <footer class="blog-footer">
      <p>
      
      Blog template created by <a href="https://twitter.com/mdo">@mdo</a>, ported to Hugo by <a href='https://twitter.com/mralanorth'>@mralanorth</a>.
      
      </p>
    </footer>

  </body>

</html>
