<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Apply Operations To Groups In Pandas" />
<meta property="og:description" content="Apply Operations To Groups In Pandas." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chrisalbon.com/python/pandas_apply_operations_to_groups/" />



<meta property="article:published_time" content="2017-12-20T11:53:49-07:00"/>

<meta property="article:modified_time" content="2017-12-20T11:53:49-07:00"/>











<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Apply Operations To Groups In Pandas"/>
<meta name="twitter:description" content="Apply Operations To Groups In Pandas."/>
<meta name="generator" content="Hugo 0.31.1" />

    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Apply Operations To Groups In Pandas",
  "url": "https://chrisalbon.com/python/pandas_apply_operations_to_groups/",
  "wordCount": "967",
  "datePublished": "2017-12-20T11:53:49-07:00",
  "dateModified": "2017-12-20T11:53:49-07:00",
  "author": {
    "@type": "Person",
    "name": "Chris Albon"
  },
  "keywords": "python, Data Wrangling",
  "description": "Apply Operations To Groups In Pandas."
}
</script>



    <link rel="canonical" href="https://chrisalbon.com/python/pandas_apply_operations_to_groups/">

    <title>Apply Operations To Groups In Pandas | Chris Albon</title>

    <!-- combined, minified CSS -->
    <link href="https://chrisalbon.com/css/style.css" rel="stylesheet" integrity="" crossorigin="anonymous">
    <link href="https://chrisalbon.com/css/main.css" rel="stylesheet" integrity="" crossorigin="anonymous">

    

    

    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

  </head>

  <body>

    <div class="blog-masthead">
      <div class="container">
        <nav class="nav blog-nav">
          <a class="nav-link" href="https://chrisalbon.com/">Home</a></nav>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-sm-12 blog-main">

          


<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="https://chrisalbon.com/python/pandas_apply_operations_to_groups/">Apply Operations To Groups In Pandas</a></h2>
    <p class="blog-post-meta"><time datetime="2017-12-20T11:53:49-07:00">Wed Dec 20, 2017</time> in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/python" rel="category tag">python</a>


<i class="fa fa-tag" aria-hidden="true"></i>&nbsp;<a href="/tags/data-wrangling" rel="tag">Data Wrangling</a>

</p>
  </header>
  

<h2 id="preliminaries">Preliminaries</h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># import modules</span>
<span style="color:#080;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">pandas</span> <span style="color:#080;font-weight:bold">as</span> <span style="color:#0e84b5;font-weight:bold">pd</span></code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Create dataframe</span>
raw_data <span style="color:#333">=</span> {<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;regiment&#39;</span>: [<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Nighthawks&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Nighthawks&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Nighthawks&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Nighthawks&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Dragoons&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Dragoons&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Dragoons&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Dragoons&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Scouts&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Scouts&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Scouts&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Scouts&#39;</span>], 
        <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;company&#39;</span>: [<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;1st&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;1st&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;2nd&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;2nd&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;1st&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;1st&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;2nd&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;2nd&#39;</span>,<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;1st&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;1st&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;2nd&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;2nd&#39;</span>], 
        <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;name&#39;</span>: [<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Miller&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Jacobson&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Ali&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Milner&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Cooze&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Jacon&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Ryaner&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Sone&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Sloan&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Piger&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Riani&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Ali&#39;</span>], 
        <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;preTestScore&#39;</span>: [<span style="color:#00d;font-weight:bold">4</span>, <span style="color:#00d;font-weight:bold">24</span>, <span style="color:#00d;font-weight:bold">31</span>, <span style="color:#00d;font-weight:bold">2</span>, <span style="color:#00d;font-weight:bold">3</span>, <span style="color:#00d;font-weight:bold">4</span>, <span style="color:#00d;font-weight:bold">24</span>, <span style="color:#00d;font-weight:bold">31</span>, <span style="color:#00d;font-weight:bold">2</span>, <span style="color:#00d;font-weight:bold">3</span>, <span style="color:#00d;font-weight:bold">2</span>, <span style="color:#00d;font-weight:bold">3</span>],
        <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;postTestScore&#39;</span>: [<span style="color:#00d;font-weight:bold">25</span>, <span style="color:#00d;font-weight:bold">94</span>, <span style="color:#00d;font-weight:bold">57</span>, <span style="color:#00d;font-weight:bold">62</span>, <span style="color:#00d;font-weight:bold">70</span>, <span style="color:#00d;font-weight:bold">25</span>, <span style="color:#00d;font-weight:bold">94</span>, <span style="color:#00d;font-weight:bold">57</span>, <span style="color:#00d;font-weight:bold">62</span>, <span style="color:#00d;font-weight:bold">70</span>, <span style="color:#00d;font-weight:bold">62</span>, <span style="color:#00d;font-weight:bold">70</span>]}
df <span style="color:#333">=</span> pd<span style="color:#333">.</span>DataFrame(raw_data, columns <span style="color:#333">=</span> [<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;regiment&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;company&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;name&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;preTestScore&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;postTestScore&#39;</span>])
df</code></pre></div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>regiment</th>
      <th>company</th>
      <th>name</th>
      <th>preTestScore</th>
      <th>postTestScore</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Nighthawks</td>
      <td>1st</td>
      <td>Miller</td>
      <td>4</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Nighthawks</td>
      <td>1st</td>
      <td>Jacobson</td>
      <td>24</td>
      <td>94</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Nighthawks</td>
      <td>2nd</td>
      <td>Ali</td>
      <td>31</td>
      <td>57</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Nighthawks</td>
      <td>2nd</td>
      <td>Milner</td>
      <td>2</td>
      <td>62</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dragoons</td>
      <td>1st</td>
      <td>Cooze</td>
      <td>3</td>
      <td>70</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Dragoons</td>
      <td>1st</td>
      <td>Jacon</td>
      <td>4</td>
      <td>25</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Dragoons</td>
      <td>2nd</td>
      <td>Ryaner</td>
      <td>24</td>
      <td>94</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Dragoons</td>
      <td>2nd</td>
      <td>Sone</td>
      <td>31</td>
      <td>57</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Scouts</td>
      <td>1st</td>
      <td>Sloan</td>
      <td>2</td>
      <td>62</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Scouts</td>
      <td>1st</td>
      <td>Piger</td>
      <td>3</td>
      <td>70</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Scouts</td>
      <td>2nd</td>
      <td>Riani</td>
      <td>2</td>
      <td>62</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Scouts</td>
      <td>2nd</td>
      <td>Ali</td>
      <td>3</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Create a groupby variable that groups preTestScores by regiment</span>
groupby_regiment <span style="color:#333">=</span> df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;preTestScore&#39;</span>]<span style="color:#333">.</span>groupby(df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;regiment&#39;</span>])
groupby_regiment</code></pre></div>
<pre><code>&lt;pandas.core.groupby.SeriesGroupBy object at 0x113ddb550&gt;
</code></pre>

<p>&ldquo;This grouped variable is now a GroupBy object. It has not actually computed anything yet except for some intermediate data about the group key df[&lsquo;key1&rsquo;]. The idea is that this object has all of the information needed to then apply some operation to each of the groups.&rdquo; - Python for Data Analysis</p>

<h2 id="view-a-grouping">View a grouping</h2>

<p>Use list() to show what a grouping looks like</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#007020">list</span>(df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;preTestScore&#39;</span>]<span style="color:#333">.</span>groupby(df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;regiment&#39;</span>]))</code></pre></div>
<pre><code>[('Dragoons', 4     3
  5     4
  6    24
  7    31
  Name: preTestScore, dtype: int64), ('Nighthawks', 0     4
  1    24
  2    31
  3     2
  Name: preTestScore, dtype: int64), ('Scouts', 8     2
  9     3
  10    2
  11    3
  Name: preTestScore, dtype: int64)]
</code></pre>

<h2 id="descriptive-statistics-by-group">Descriptive statistics by group</h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;preTestScore&#39;</span>]<span style="color:#333">.</span>groupby(df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;regiment&#39;</span>])<span style="color:#333">.</span>describe()</code></pre></div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>regiment</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Dragoons</th>
      <td>4.0</td>
      <td>15.50</td>
      <td>14.153916</td>
      <td>3.0</td>
      <td>3.75</td>
      <td>14.0</td>
      <td>25.75</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>Nighthawks</th>
      <td>4.0</td>
      <td>15.25</td>
      <td>14.453950</td>
      <td>2.0</td>
      <td>3.50</td>
      <td>14.0</td>
      <td>25.75</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>Scouts</th>
      <td>4.0</td>
      <td>2.50</td>
      <td>0.577350</td>
      <td>2.0</td>
      <td>2.00</td>
      <td>2.5</td>
      <td>3.00</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="mean-of-each-regiment-s-pretestscore">Mean of each regiment&rsquo;s preTestScore</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">groupby_regiment<span style="color:#333">.</span>mean()</code></pre></div>
<pre><code>regiment
Dragoons      15.50
Nighthawks    15.25
Scouts         2.50
Name: preTestScore, dtype: float64
</code></pre>

<h3 id="mean-pretestscores-grouped-by-regiment-and-company">Mean preTestScores grouped by regiment and company</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;preTestScore&#39;</span>]<span style="color:#333">.</span>groupby([df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;regiment&#39;</span>], df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;company&#39;</span>]])<span style="color:#333">.</span>mean()</code></pre></div>
<pre><code>regiment    company
Dragoons    1st         3.5
            2nd        27.5
Nighthawks  1st        14.0
            2nd        16.5
Scouts      1st         2.5
            2nd         2.5
Name: preTestScore, dtype: float64
</code></pre>

<h3 id="mean-pretestscores-grouped-by-regiment-and-company-without-heirarchical-indexing">Mean preTestScores grouped by regiment and company without heirarchical indexing</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;preTestScore&#39;</span>]<span style="color:#333">.</span>groupby([df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;regiment&#39;</span>], df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;company&#39;</span>]])<span style="color:#333">.</span>mean()<span style="color:#333">.</span>unstack()</code></pre></div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>company</th>
      <th>1st</th>
      <th>2nd</th>
    </tr>
    <tr>
      <th>regiment</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Dragoons</th>
      <td>3.5</td>
      <td>27.5</td>
    </tr>
    <tr>
      <th>Nighthawks</th>
      <td>14.0</td>
      <td>16.5</td>
    </tr>
    <tr>
      <th>Scouts</th>
      <td>2.5</td>
      <td>2.5</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="group-the-entire-dataframe-by-regiment-and-company">Group the entire dataframe by regiment and company</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#333">.</span>groupby([<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;regiment&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;company&#39;</span>])<span style="color:#333">.</span>mean()</code></pre></div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>preTestScore</th>
      <th>postTestScore</th>
    </tr>
    <tr>
      <th>regiment</th>
      <th>company</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Dragoons</th>
      <th>1st</th>
      <td>3.5</td>
      <td>47.5</td>
    </tr>
    <tr>
      <th>2nd</th>
      <td>27.5</td>
      <td>75.5</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Nighthawks</th>
      <th>1st</th>
      <td>14.0</td>
      <td>59.5</td>
    </tr>
    <tr>
      <th>2nd</th>
      <td>16.5</td>
      <td>59.5</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Scouts</th>
      <th>1st</th>
      <td>2.5</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>2nd</th>
      <td>2.5</td>
      <td>66.0</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="number-of-observations-in-each-regiment-and-company">Number of observations in each regiment and company</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#333">.</span>groupby([<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;regiment&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;company&#39;</span>])<span style="color:#333">.</span>size()</code></pre></div>
<pre><code>regiment    company
Dragoons    1st        2
            2nd        2
Nighthawks  1st        2
            2nd        2
Scouts      1st        2
            2nd        2
dtype: int64
</code></pre>

<h2 id="iterate-an-operations-over-groups">Iterate an operations over groups</h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Group the dataframe by regiment, and for each regiment,</span>
<span style="color:#080;font-weight:bold">for</span> name, group <span style="color:#000;font-weight:bold">in</span> df<span style="color:#333">.</span>groupby(<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;regiment&#39;</span>): 
    <span style="color:#888"># print the name of the regiment</span>
    <span style="color:#080;font-weight:bold">print</span>(name)
    <span style="color:#888"># print the data of that regiment</span>
    <span style="color:#080;font-weight:bold">print</span>(group)</code></pre></div>
<pre><code>Dragoons
   regiment company    name  preTestScore  postTestScore
4  Dragoons     1st   Cooze             3             70
5  Dragoons     1st   Jacon             4             25
6  Dragoons     2nd  Ryaner            24             94
7  Dragoons     2nd    Sone            31             57
Nighthawks
     regiment company      name  preTestScore  postTestScore
0  Nighthawks     1st    Miller             4             25
1  Nighthawks     1st  Jacobson            24             94
2  Nighthawks     2nd       Ali            31             57
3  Nighthawks     2nd    Milner             2             62
Scouts
   regiment company   name  preTestScore  postTestScore
8    Scouts     1st  Sloan             2             62
9    Scouts     1st  Piger             3             70
10   Scouts     2nd  Riani             2             62
11   Scouts     2nd    Ali             3             70
</code></pre>

<h3 id="group-by-columns">Group by columns</h3>

<p>Specifically in this case: group by the data types of the columns (i.e. axis=1) and then use list() to view what that grouping looks like</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#007020">list</span>(df<span style="color:#333">.</span>groupby(df<span style="color:#333">.</span>dtypes, axis<span style="color:#333">=</span><span style="color:#00d;font-weight:bold">1</span>))</code></pre></div>
<pre><code>[(dtype('int64'),     preTestScore  postTestScore
  0              4             25
  1             24             94
  2             31             57
  3              2             62
  4              3             70
  5              4             25
  6             24             94
  7             31             57
  8              2             62
  9              3             70
  10             2             62
  11             3             70),
 (dtype('O'),       regiment company      name
  0   Nighthawks     1st    Miller
  1   Nighthawks     1st  Jacobson
  2   Nighthawks     2nd       Ali
  3   Nighthawks     2nd    Milner
  4     Dragoons     1st     Cooze
  5     Dragoons     1st     Jacon
  6     Dragoons     2nd    Ryaner
  7     Dragoons     2nd      Sone
  8       Scouts     1st     Sloan
  9       Scouts     1st     Piger
  10      Scouts     2nd     Riani
  11      Scouts     2nd       Ali)]
</code></pre>

<h3 id="in-the-dataframe-df-group-by-regiments-take-the-mean-values-of-the-other-variables-for-those-groups-then-display-them-with-the-prefix-mean">In the dataframe &ldquo;df&rdquo;, group by &ldquo;regiments, take the mean values of the other variables for those groups, then display them with the prefix_mean</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#333">.</span>groupby(<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;regiment&#39;</span>)<span style="color:#333">.</span>mean()<span style="color:#333">.</span>add_prefix(<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;mean_&#39;</span>)</code></pre></div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean_preTestScore</th>
      <th>mean_postTestScore</th>
    </tr>
    <tr>
      <th>regiment</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Dragoons</th>
      <td>15.50</td>
      <td>61.5</td>
    </tr>
    <tr>
      <th>Nighthawks</th>
      <td>15.25</td>
      <td>59.5</td>
    </tr>
    <tr>
      <th>Scouts</th>
      <td>2.50</td>
      <td>66.0</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="create-a-function-to-get-the-stats-of-a-group">Create a function to get the stats of a group</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#080;font-weight:bold">def</span> <span style="color:#06b;font-weight:bold">get_stats</span>(group):
    <span style="color:#080;font-weight:bold">return</span> {<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;min&#39;</span>: group<span style="color:#333">.</span><span style="color:#007020">min</span>(), <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;max&#39;</span>: group<span style="color:#333">.</span><span style="color:#007020">max</span>(), <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;count&#39;</span>: group<span style="color:#333">.</span>count(), <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;mean&#39;</span>: group<span style="color:#333">.</span>mean()}</code></pre></div>
<h3 id="create-bins-and-bin-up-posttestscore-by-those-pins">Create bins and bin up postTestScore by those pins</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">bins <span style="color:#333">=</span> [<span style="color:#00d;font-weight:bold">0</span>, <span style="color:#00d;font-weight:bold">25</span>, <span style="color:#00d;font-weight:bold">50</span>, <span style="color:#00d;font-weight:bold">75</span>, <span style="color:#00d;font-weight:bold">100</span>]
group_names <span style="color:#333">=</span> [<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Low&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Okay&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Good&#39;</span>, <span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;Great&#39;</span>]
df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;categories&#39;</span>] <span style="color:#333">=</span> pd<span style="color:#333">.</span>cut(df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;postTestScore&#39;</span>], bins, labels<span style="color:#333">=</span>group_names)</code></pre></div>
<h3 id="apply-the-get-stats-function-to-each-posttestscore-bin">Apply the get_stats() function to each postTestScore bin</h3>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;postTestScore&#39;</span>]<span style="color:#333">.</span>groupby(df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;categories&#39;</span>])<span style="color:#333">.</span><span style="color:#007020">apply</span>(get_stats)<span style="color:#333">.</span>unstack()</code></pre></div>
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>max</th>
      <th>mean</th>
      <th>min</th>
    </tr>
    <tr>
      <th>categories</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Good</th>
      <td>8.0</td>
      <td>70.0</td>
      <td>63.75</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>Great</th>
      <td>2.0</td>
      <td>94.0</td>
      <td>94.00</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>Low</th>
      <td>2.0</td>
      <td>25.0</td>
      <td>25.00</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>Okay</th>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>


</article> 



        </div> <!-- /.blog-main -->

      </div> <!-- /.row -->
    </div> <!-- /.container -->

    <footer class="blog-footer">
      <p>
      
      Blog template created by <a href="https://twitter.com/mdo">@mdo</a>, ported to Hugo by <a href='https://twitter.com/mralanorth'>@mralanorth</a>.
      
      </p>
    </footer>

  </body>

</html>
