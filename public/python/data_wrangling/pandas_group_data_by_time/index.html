<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Group Data By Time" />
<meta property="og:description" content="Group data by time." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chrisalbon.com/python/data_wrangling/pandas_group_data_by_time/" />



<meta property="article:published_time" content="2017-12-20T11:53:49-07:00"/>

<meta property="article:modified_time" content="2017-12-20T11:53:49-07:00"/>











<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="Group Data By Time"/>
<meta name="twitter:description" content="Group data by time."/>
<meta name="generator" content="Hugo 0.31.1" />

    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Group Data By Time",
  "url": "https://chrisalbon.com/python/data_wrangling/pandas_group_data_by_time/",
  "wordCount": "525",
  "datePublished": "2017-12-20T11:53:49-07:00",
  "dateModified": "2017-12-20T11:53:49-07:00",
  "author": {
    "@type": "Person",
    "name": "Chris Albon"
  },
  "description": "Group data by time."
}
</script>



    <link rel="canonical" href="https://chrisalbon.com/python/data_wrangling/pandas_group_data_by_time/">

    <title>Group Data By Time | Chris Albon</title>

    <!-- combined, minified CSS -->
    <link href="https://chrisalbon.com/css/style.css" rel="stylesheet" integrity="" crossorigin="anonymous">
    <link href="https://chrisalbon.com/css/main.css" rel="stylesheet" integrity="" crossorigin="anonymous">

    

    

    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

  </head>

  <body>

    <div class="blog-masthead">
      <div class="container">
        <nav class="nav blog-nav">
          <a class="nav-link" href="https://chrisalbon.com/">Home</a></nav>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-sm-12 blog-main">

          


<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="https://chrisalbon.com/python/data_wrangling/pandas_group_data_by_time/">Group Data By Time</a></h2>
    <p class="blog-post-meta"><time datetime="2017-12-20T11:53:49-07:00">Wed Dec 20, 2017</time></p>
  </header>
  

<p>On March 13, 2016, version 0.18.0 of Pandas was released, with significant changes in how the resampling function operates. This tutorial follows v0.18.0 and will not work for previous versions of pandas.</p>

<p>First let&rsquo;s load the modules we care about</p>

<h2 id="preliminaries">Preliminaries</h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Import required packages</span>
<span style="color:#080;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">pandas</span> <span style="color:#080;font-weight:bold">as</span> <span style="color:#0e84b5;font-weight:bold">pd</span>
<span style="color:#080;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">datetime</span>
<span style="color:#080;font-weight:bold">import</span> <span style="color:#0e84b5;font-weight:bold">numpy</span> <span style="color:#080;font-weight:bold">as</span> <span style="color:#0e84b5;font-weight:bold">np</span></code></pre></div>
<p>Next, let&rsquo;s create some sample data that we can group by time as an sample. In this example I am creating a dataframe with two columns with 365 rows. One column is a date, the second column is a numeric value.</p>

<h2 id="create-data">Create Data</h2>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Create a datetime variable for today</span>
base <span style="color:#333">=</span> datetime<span style="color:#333">.</span>datetime<span style="color:#333">.</span>today()
<span style="color:#888"># Create a list variable that creates 365 days of rows of datetime values</span>
date_list <span style="color:#333">=</span> [base <span style="color:#333">-</span> datetime<span style="color:#333">.</span>timedelta(days<span style="color:#333">=</span>x) <span style="color:#080;font-weight:bold">for</span> x <span style="color:#000;font-weight:bold">in</span> <span style="color:#007020">range</span>(<span style="color:#00d;font-weight:bold">0</span>, <span style="color:#00d;font-weight:bold">365</span>)]</code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Create a list variable of 365 numeric values</span>
score_list <span style="color:#333">=</span> <span style="color:#007020">list</span>(np<span style="color:#333">.</span>random<span style="color:#333">.</span>randint(low<span style="color:#333">=</span><span style="color:#00d;font-weight:bold">1</span>, high<span style="color:#333">=</span><span style="color:#00d;font-weight:bold">1000</span>, size<span style="color:#333">=</span><span style="color:#00d;font-weight:bold">365</span>))</code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Create an empty dataframe</span>
df <span style="color:#333">=</span> pd<span style="color:#333">.</span>DataFrame()

<span style="color:#888"># Create a column from the datetime variable</span>
df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;datetime&#39;</span>] <span style="color:#333">=</span> date_list
<span style="color:#888"># Convert that column into a datetime datatype</span>
df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;datetime&#39;</span>] <span style="color:#333">=</span> pd<span style="color:#333">.</span>to_datetime(df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;datetime&#39;</span>])
<span style="color:#888"># Set the datetime column as the index</span>
df<span style="color:#333">.</span>index <span style="color:#333">=</span> df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;datetime&#39;</span>] 
<span style="color:#888"># Create a column from the numeric score variable</span>
df[<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;score&#39;</span>] <span style="color:#333">=</span> score_list</code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Let&#39;s take a took at the data</span>
df<span style="color:#333">.</span>head()</code></pre></div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>datetime</th>
      <th>score</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016-06-02 09:57:54.793972</th>
      <td>2016-06-02 09:57:54.793972</td>
      <td>900</td>
    </tr>
    <tr>
      <th>2016-06-01 09:57:54.793972</th>
      <td>2016-06-01 09:57:54.793972</td>
      <td>121</td>
    </tr>
    <tr>
      <th>2016-05-31 09:57:54.793972</th>
      <td>2016-05-31 09:57:54.793972</td>
      <td>547</td>
    </tr>
    <tr>
      <th>2016-05-30 09:57:54.793972</th>
      <td>2016-05-30 09:57:54.793972</td>
      <td>504</td>
    </tr>
    <tr>
      <th>2016-05-29 09:57:54.793972</th>
      <td>2016-05-29 09:57:54.793972</td>
      <td>304</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="group-data-by-date">Group Data By Date</h2>

<p>In pandas, the most common way to group by time is to use the .resample() function. In v0.18.0 this function is two-stage. This means that &lsquo;df.resample(&rsquo;M&rsquo;)&rsquo; creates an object to which we can apply other functions (&lsquo;mean&rsquo;, &lsquo;count&rsquo;, &lsquo;sum&rsquo;, etc.)</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Group the data by month, and take the mean for each group (i.e. each month)</span>
df<span style="color:#333">.</span>resample(<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;M&#39;</span>)<span style="color:#333">.</span>mean()</code></pre></div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>score</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-06-30</th>
      <td>513.629630</td>
    </tr>
    <tr>
      <th>2015-07-31</th>
      <td>561.516129</td>
    </tr>
    <tr>
      <th>2015-08-31</th>
      <td>448.032258</td>
    </tr>
    <tr>
      <th>2015-09-30</th>
      <td>548.000000</td>
    </tr>
    <tr>
      <th>2015-10-31</th>
      <td>480.419355</td>
    </tr>
    <tr>
      <th>2015-11-30</th>
      <td>487.033333</td>
    </tr>
    <tr>
      <th>2015-12-31</th>
      <td>499.935484</td>
    </tr>
    <tr>
      <th>2016-01-31</th>
      <td>429.193548</td>
    </tr>
    <tr>
      <th>2016-02-29</th>
      <td>520.413793</td>
    </tr>
    <tr>
      <th>2016-03-31</th>
      <td>349.806452</td>
    </tr>
    <tr>
      <th>2016-04-30</th>
      <td>395.500000</td>
    </tr>
    <tr>
      <th>2016-05-31</th>
      <td>503.451613</td>
    </tr>
    <tr>
      <th>2016-06-30</th>
      <td>510.500000</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#888"># Group the data by month, and take the sum for each group (i.e. each month)</span>
df<span style="color:#333">.</span>resample(<span style="background-color:#fff0f0"></span><span style="background-color:#fff0f0">&#39;M&#39;</span>)<span style="color:#333">.</span><span style="color:#007020">sum</span>()</code></pre></div>
<div>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>score</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2015-06-30</th>
      <td>13868</td>
    </tr>
    <tr>
      <th>2015-07-31</th>
      <td>17407</td>
    </tr>
    <tr>
      <th>2015-08-31</th>
      <td>13889</td>
    </tr>
    <tr>
      <th>2015-09-30</th>
      <td>16440</td>
    </tr>
    <tr>
      <th>2015-10-31</th>
      <td>14893</td>
    </tr>
    <tr>
      <th>2015-11-30</th>
      <td>14611</td>
    </tr>
    <tr>
      <th>2015-12-31</th>
      <td>15498</td>
    </tr>
    <tr>
      <th>2016-01-31</th>
      <td>13305</td>
    </tr>
    <tr>
      <th>2016-02-29</th>
      <td>15092</td>
    </tr>
    <tr>
      <th>2016-03-31</th>
      <td>10844</td>
    </tr>
    <tr>
      <th>2016-04-30</th>
      <td>11865</td>
    </tr>
    <tr>
      <th>2016-05-31</th>
      <td>15607</td>
    </tr>
    <tr>
      <th>2016-06-30</th>
      <td>1021</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="grouping-options">Grouping Options</h2>

<p>There are many options for grouping. You can learn more about them in <a href="http://pandas.pydata.org/pandas-docs/stable/timeseries.html">Pandas&rsquo;s timeseries docs</a>, however, I have also listed them below for your convience.</p>

<p>| Value | Description
|&mdash;|
|B   |    business day frequency
|C   |    custom business day frequency (experimental)
|D   |    calendar day frequency
|W   |    weekly frequency
|M   |    month end frequency
|BM  |    business month end frequency
|CBM |    custom business month end frequency
|MS  |    month start frequency
|BMS |    business month start frequency
|CBMS|    custom business month start frequency
|Q   |    quarter end frequency
|BQ  |    business quarter endfrequency
|QS  |    quarter start frequency
|BQS |    business quarter start frequency
|A   |    year end frequency
|BA  |    business year end frequency
|AS  |    year start frequency
|BAS |    business year start frequency
|BH  |    business hour frequency
|H   |    hourly frequency
|T   |    minutely frequency
|S   |    secondly frequency
|L   |    milliseonds
|U   |    microseconds
|N   |    nanosecondsa</p>


</article> 



        </div> <!-- /.blog-main -->

      </div> <!-- /.row -->
    </div> <!-- /.container -->

    <footer class="blog-footer">
      <p>
      
      Blog template created by <a href="https://twitter.com/mdo">@mdo</a>, ported to Hugo by <a href='https://twitter.com/mralanorth'>@mralanorth</a>.
      
      </p>
    </footer>

  </body>

</html>
